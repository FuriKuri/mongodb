<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Mongodb by FuriKuri</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">MongoDB</h1>
        <p class="header">MongoDB Workshop</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/FuriKuri/mongodb/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/FuriKuri/mongodb/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/FuriKuri/mongodb">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/FuriKuri">FuriKuri</a></p>


      </header>
      <section>
        <h2>Die LÃ¶sungen</h2>
        <h3>Aufgabe 1</h3>
        <code><pre>
db.data.find({ "Wind Direction" : { $gt : 180, $lt : 360 } })
       .sort({ "Temperature" : 1 })
       .limit(3)
       .pretty()
      </pre></code>
        <h3>Aufgabe 2</h3>
        <code><pre>
var MongoClient = require('mongodb').MongoClient;

MongoClient.connect('mongodb://localhost:27017/weather', function(err, db) {
  if(err) throw err;

  var grades = db.collection('data');
  var cursor = grades.find({});
  cursor.sort([['State', 1], ['Temperature', -1]]);

  var lastState = '';
  cursor.each(function(err, doc) {
    if(err) throw err;
    if(doc == null) {
      return db.close();
    }
    var currentState = doc['State']

    if (lastState == '' || currentState != lastState) {
      lastState = currentState;
      doc['month_high'] = true;
      grades.save(doc, function(err, saved) {
        console.dir(doc);
      });
    }
  });
});
      </pre></code>
        <h3>Aufgabe 3</h3>
        <h4>Java</h4>
        <code><pre>
BasicDBObject user = new BasicDBObject();
user.append("_id", username).append("password", passwordHash);
if (email != null && !email.equals("")) {
    user.append("email", email);
}
try {
    usersCollection.insert(user);
} ...


user = usersCollection.findOne(new BasicDBObject("_id", username));
        </pre></code>
        <h4>Node</h4>
        <code><pre>
var user = {'_id': username, 'password': password_hash};
if (email != "") {
    user['email'] = email;
}
users.insert(user, function (err, result) {
    if (!err) {
        return callback(null, result);
    }
    return callback(err, null);
});


users.findOne({ '_id' : username }, validateUserDoc);
      </pre></code>
        <h3>Aufgabe 4</h3>
        <code><pre>
var MongoClient = require('mongodb').MongoClient;

MongoClient.connect('mongodb://localhost:27017/school', function(err, db) {
    if(err) throw err;

    var students = db.collection('students');
    var cursor = students.find({});

    cursor.each(function(err, doc) {
        if(err) throw err;
        if(doc == null) {
            return db.close();
        }
        var scores = doc.scores;
        var lowestScore = null;
        var scoreDoc = null;
        scores.forEach(function(score) {
          if (score.type == 'homework') {
            if (lowestScore == null || score.score < lowestScore) {
              lowestScore = score.score;
              scoreDoc = score;
            }
          }
        });
        scores.splice(scores.indexOf(scoreDoc), 1);
        grades.save(doc, function(err, saved) {
          console.dir(saved);
        });

    });
});</pre></code>
        <h3>Aufgabe 5</h3>
        <h3>Aufgabe 6</h3>
        <h3>Aufgabe 7</h3>
        <h3>Aufgabe 8</h3>
        <h3>Aufgabe 9</h3>
        <h3>Aufgabe 10</h3>
        <h3>Aufgabe 11</h3>
        <h3>Aufgabe 12</h3>
        <h3>Aufgabe 13</h3>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

  </body>
</html>
